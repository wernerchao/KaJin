<!DOCTYPE html>
<html>
    <head>
        <meta charset='UTF-8'>
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
        <title>Star Rating Project</title>
        <style>
            .formContainer {
                text-align: center;
                margin: 0 auto;
                border: 5px solid white;
                background-color:  #EDEDED;
                width: 400px;
                height: 400px;
                display: none;
            }

            .ratingForm {
                margin: 50px auto;
            }

            .caption {
                margin-bottom: 50px;
                font-size: 24px;
                color: #A1A1A1;
            }

            .rating {
                width: 200px;
                display: inline-block;
                text-align: left;
                color: #A1A1A1;
            }

            .ratingForm textarea {
                margin-top: 10px;
                height: 100px;
                width: 70%;
                border-radius: 5px;
                border-color: #A6A6A6; opacity: 0.5;
            }

            .ratingForm textarea::-webkit-input-placeholder {
                padding: 10px 0 0 10px;
            }
            
            .btn {
                background-color: #6BC4CA;
                color: white;
                width: 150px;
                margin: 0 auto;
                margin-top: 15px;
                padding: 5px;
                text-align: center;
                font-size: 16px;
                border-radius: 5px;
                cursor: pointer;
            }

            .fa, .fa-star { /*filled star*/
                font-size: 24px;
                color: #67C4CB;
                cursor: pointer;
            }

            .fa-star-o { /*empty star*/
                display: inline-block;
                cursor: pointer;
            }
        </style>
        
    </head>
    
    <body>
        <div class="formContainer">
            <form class="ratingForm">
                    <div class="caption">給予諮詢老師評價！</div>
                    <div class='rating r1'>老師能理解我的問題</div><span></span><br>
                    <div class='rating r2'>老師對我的情況有幫助</div><span></span><br>
                    <div class='rating r3'>值不值得推薦</div><span></span><br>
                    <textarea rows='4' cols='50' id='textRating' placeholder='說說你的感受...'></textarea>
                    <button type='submit' id='submitRating' class='btn' val='完成'>完成</button>
            </form>
        </div>

        <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase.js"></script>
        <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyDB4GLrZbqF3mNXTyZaeODj0QDtLVf2do8",
            authDomain: "blistering-torch-1115.firebaseapp.com",
            databaseURL: "https://blistering-torch-1115.firebaseio.com",
            storageBucket: "blistering-torch-1115.appspot.com",
        };
        firebase.initializeApp(config);
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <script src="jquery.lightbox_me.js"></script> <!--popup window plugin js-->
        <script>
            $(document).ready(function() {

                var thanks = $('.rating').text();
                var index;
                var ratingObj = {}
                $('.rating').next().append('<i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i><i class="fa fa-star-o"></i>'); // append the stars
                $('.formContainer').lightbox_me({
                    centered: true
                });
                
                //when the form is submitted, pass the data through ajax call
                $('.ratingForm').submit(function(event) { 
                    //something happens when the submit button is clicked
                    var testText = $(this).children("textarea").val();
                    console.log(ratingObj);
                    console.log(testText);
                    /*$.ajax({
                                type: 'POST',
                                url: 'add.php',
                                datatype: 'json',
                                success: function(data) {
                                    console.log("nothing yet");
                                }
                            });*/
                    event.preventDefault();
                    return false;
                });

                //when the stars are clicked, pass the score and the relevant text to the ratingObj
                $('.rating').next().on('click','i',function(){
                        if(thanks!='thanks') {
                            index = $(this).index()+1; //get the rating score, out of 5
                            var text = $(this).parent().prev().text(); //get the specific text of the rating selected
                            ratingObj[text]=index;
                            $(this).nextAll().removeClass('fa-star').addClass('fa-star-o');
                            $(this).prevAll().removeClass('fa-star-o').addClass('fa-star'); //the star(s) before the mouse click location
                            $(this).removeClass('fa-star-o').addClass('fa-star'); //the star on the mouse click location
                        }
                });
            });
        </script>    
    </body>
</html>